# スプレッドシート連携セットアップガイド

このガイドでは、OSGアプリケーションとGoogleスプレッドシートを連携させる手順を説明します。

## 📋 セットアップ手順

### ステップ1: GASスクリプトをデプロイ

1. **スプレッドシートを開く**
   - 「作業者交替管理一覧表」を含むスプレッドシートを開きます

2. **Apps Scriptエディタを開く**
   - メニューバー →「拡張機能」→「Apps Script」

3. **スクリプトをコピー**
   - `gas/Code.gs` の内容を全てコピー
   - Apps Scriptエディタに​​ています

4. **デプロイ**
   - 詳細な手順は `gas/README.md` を参照してください
   - デプロイ後に取得したURLをメモしておきます

### ステップ2: フロントエンドの設定

1. **config.jsを編集**
   ```javascript
   // js/config.js
   const CONFIG = {
     GAS_URL: 'https://script.google.com/macros/s/【あなたのデプロイID】/exec',
     // ...
   };
   ```

2. **ブラウザでindex.htmlを開く**
   - 自動的にスプレッドシートからデータを取得します
   - ローディング表示の後、データが表示されます

### ステップ3: 動作確認

以下の機能が正常に動作すること確認してください：

- [  ] データの読み込み（5000行以上）
- [ ] 検索機能（ID、ライン、作業者、品番、品名）
- [ ] フィルター: すべて
- [ ] フィルター: 未確認（completionStatus='T'またはs,t,u,v列に値）
- [ ] フィルター: 本日（occurrenceDate が今日の日付）
- [ ] フィルター: 職場別（distributionCode にP/A/C）
- [ ] カードの展開（製造課・品質管理課の詳細表示）
- [ ] 正しいソート順（No.降順）

## 🔧 トラブルシューティング

### データが表示されない

1. **ブラウザのコンソールを確認**
   - F12キーを押して開発者ツールを開く
   - Consoleタブでエラーメッセージを確認

2. **config.jsのURLを確認**
   - `YOUR_GAS_DEPLOYMENT_URL_HERE` が実際のデプロイURLに置き換わっているか

3. **GASデプロイを確認**
   - デプロイURLをブラウザで直接開いてJSONが返ってくるか確認

### CORSエラーが発生する

- GASは自動的にCORSを処理するため、通常は発生しません
- もし発生した場合は、ブラウザのキャッシュをクリアしてみてください

### データが古い

- ブラウザはデータを5分間キャッシュします
- 強制的に最新データを取得するには、ページをリロード（F5キー）してください

## 📝 次のステップ

データ表示が正常に動作したら、次の機能を実装できます：

1. **データ編集機能**
   - カード上で直接データを編集
   - スプレッドシートに反映

2. **データ追加機能**
   - 新しいレコードを追加

3. **認証機能**
   - Google OAuth 2.0認証
   - ロールベースアクセス制御
